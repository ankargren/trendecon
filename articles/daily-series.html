<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating long daily series • trendecon</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating long daily series">
<meta property="og:description" content="trendecon">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trendecon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/daily-series.html">Creating long daily series</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to trendecon</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/trendecon/trendecon/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="daily-series_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Creating long daily series</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/trendecon/trendecon/blob/master/vignettes/daily-series.Rmd"><code>vignettes/daily-series.Rmd</code></a></small>
      <div class="hidden name"><code>daily-series.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">trendecon</span>)</pre></body></html></div>
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h2>
<p>Google search results are available on a daily, weekly or monthly frequency. As with individual samples, querying Google at a different frequency will lead to substantially different results.</p>
<p>Our goal is to produce long daily time series, ideally from 2006. However, Google does not provide daily or weekly data for such a long time period. We circumvent the problem by applying a moving window of daily and weekly queries over the whole time period.</p>
<p>This vingette describes the production processes of trendecon. The production function start with <code>proc_</code> and usually operate on the file system. That means that calling this functions will write to your disk.</p>
</div>
<div id="directory-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#directory-structure" class="anchor"></a>Directory structure</h2>
<p>The <code>proc_</code> functions write to the working directory. If you are unsure about your current working directory, use <code><a href="https://rdrr.io/r/base/getwd.html">getwd()</a></code>.</p>
<p>Within the working directory, the <code>proc_</code> functions assume the existence of two folders,</p>
<ul>
<li><code>data</code></li>
<li><code>raw</code></li>
</ul>
<p>which, if not present, are created when calling <code>proc_keyword_init</code> for the first time.</p>
<p>Within these folders, there is a subfolder for every <code>geo</code> location. Thus, you may see the following subfolders</p>
<ul>
<li><code>data/ch</code></li>
<li><code>data/at</code></li>
<li><code>raw/ch</code></li>
<li><code>raw/at</code></li>
</ul>
<p>What is the difference between <code>data</code> and <code>raw</code>? In the <code>raw</code> folder, we collect all the data downloaded from Google, plus some transfromations, such as the seasonally adjusted or the combined series.</p>
<p>In the <code>data</code> folder, we collect our final indicators - the data you see on the website.</p>
</div>
<div id="initial-download" class="section level2">
<h2 class="hasAnchor">
<a href="#initial-download" class="anchor"></a>Initial Download</h2>
<p>To include a new series, each keyword must be initiated. Be careful, as this causes a lot of queries to Google.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/proc_keyword_init.html">proc_keyword_init</a></span>(<span class="st">"Rezession"</span>, <span class="st">"CH"</span>)</pre></body></html></div>
<p>After running we have the aggregated series at daily, weekly and monthly frequency, stored in the <code>raw</code> folder. In the example above, the files <code>raw/ch/Rezession_d.csv</code>, <code>raw/ch/Rezession_w.csv</code>, and <code>raw/ch/Rezession_m.csv</code> are created.</p>
</div>
<div id="updating-trendecon-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#updating-trendecon-indicators" class="anchor"></a>Updating trendecon indicators</h2>
<p>Trendecon includes a few functions that process a collection of keywords. These functions produce the indicators that we show on trendecon.org. These are called by our automated process on GitHub, so they usually do not need to be called manually.</p>
<p>To process all Swiss indicators of trendecon, run:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/proc_trendecon_ch.html">proc_trendecon_ch</a></span>()</pre></body></html></div>
<p>Once all the keywords are initiated, <code><a href="../reference/proc_trendecon_ch.html">proc_trendecon_ch()</a></code> updates the series for each keyword, and produces the indicators. In the final step, the data is copied to the data repository.</p>
<ul>
<li>
<input type="checkbox" disabled>
TODO: what data exactly is copied?</li>
<li>
<input type="checkbox" disabled>
TODO: describe where the list of keywords which need to be initiated can be found.</li>
</ul>
<p>While <code><a href="../reference/proc_trendecon_ch.html">proc_trendecon_ch()</a></code> automatically updates our indicators, it is insightful to walk through the different steps it performs, as these are the steps which are required to build indicators from other sets of keywords or for other countries.</p>
<div id="scripts-for-each-indicator" class="section level3">
<h3 class="hasAnchor">
<a href="#scripts-for-each-indicator" class="anchor"></a>Scripts for each indicator</h3>
<p>To construct each indicator, an indicator-specific script in the folder <code>inst/script</code> is called. For example</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="st">"inst/script/trendecon.R"</span>)</pre></body></html></div>
<p>produces the indicator for economic sentiment. To do so, it first performs a number of steps for each keyword on which the indicator is based. For example, our main indicator is based on the keywords <code>"Wirtschaftskrise"</code>, <code>"Kurzarbeit  "</code>, <code>"arbeitslos"</code>, and <code>"Insolvenz"</code>. Once the data for each keyword has been processed, the actual indicator is constructed from the individual keyword-series using a principal-component approach.</p>
<p>Below, we describe the steps which are performed for each of the keywords. All these steps are bundled together in the function <code>proc_keyword</code>.</p>
<div id="bundled-steps-for-each-keyword" class="section level4">
<h4 class="hasAnchor">
<a href="#bundled-steps-for-each-keyword" class="anchor"></a>Bundled steps for each keyword</h4>
<p>For each keyword, <code>proc_keyword</code> is called, for example</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/proc_keyword.html">proc_keyword</a></span>(<span class="st">"Rezession"</span>, <span class="st">"CH"</span>)</pre></body></html></div>
<p>which in turn performs the following steps.</p>
<div id="update-data-series-with-latest-data" class="section level5">
<h5 class="hasAnchor">
<a href="#update-data-series-with-latest-data" class="anchor"></a>Update data series with latest data</h5>
<p>In the first step, the raw data series for each keyword are updated with the latest daily, weekly, and monthly data. For example, to update the raw series for keyword <code>"Rezession"</code> for Switzerland, call</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/proc_keyword_latest.html">proc_keyword_latest</a></span>(<span class="st">"Rezession"</span>, <span class="st">"CH"</span>)</pre></body></html></div>
<ul>
<li>
<input type="checkbox" disabled>
TODO: This will fail without proper error if <code>proc_keyword_init</code> has not been run.</li>
</ul>
</div>
<div id="bending" class="section level5">
<h5 class="hasAnchor">
<a href="#bending" class="anchor"></a>Bending</h5>
<p>To combine the three frequencies, we apply the following methodology: In a first step, we “bend” the daily series to the weekly values, by applying a variant of the Chow-Lin (1971) method. This preserves the movement of the daily series and ensures that weekly averages are identical to the original weekly series. We then use the same methodology to bend the series to the monhtly values.</p>
<p>To combine the three frequencies for a given keyword, use:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu">proc_combine_freq</span>(<span class="st">"Rezession"</span>, <span class="st">"CH"</span>)</pre></body></html></div>
</div>
<div id="seasonal-adjustment" class="section level5">
<h5 class="hasAnchor">
<a href="#seasonal-adjustment" class="anchor"></a>Seasonal Adjustment</h5>
<ul>
<li>
<input type="checkbox" disabled>
FXIME some text from the website</li>
</ul>
<p>To seasonally adjust a combined keyword, use:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu">proc_seas_adj</span>(<span class="st">"Rezession"</span>, <span class="st">"CH"</span>)</pre></body></html></div>
</div>
<div id="reading-and-writing" class="section level5">
<h5 class="hasAnchor">
<a href="#reading-and-writing" class="anchor"></a>Reading and Writing</h5>
<p>There are two special helper functions that are useful when working with production data:</p>
<ul>
<li><code>read_keyword</code></li>
<li><code>write_keyword</code></li>
</ul>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Angelica Becerra, Nina Mühlebach, Christoph Sax, Sverin Thoeni, Uwe Thuemmel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
